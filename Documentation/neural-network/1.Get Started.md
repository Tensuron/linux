# Get Started

## Overview

The enhanced neural network implementation (`include/uapi/linux/neural.c`) provides a high-performance, kernel-space neural network designed for AI-powered security systems. It features NUMA awareness, SIMD optimizations, advanced security, and comprehensive monitoring.

## Basic Usage

### Include Library

```c
#include <linux/neural.h>
```

### 1. Network Initialization

Syntax:
```c
int neural_network_init(neural_network_t *nn, u32 input_size, u32 hidden_size, u32 output_size, bool use_batch_norm, f32 dropout_rate);
```

Example:

```c
#include <linux/neural.h>

neural_network_t *nn;
int ret;

// Allocate network structure
nn = kzalloc(sizeof(neural_network_t), GFP_KERNEL);
if (!nn)
    return -ENOMEM;

// Initialize network: 256 inputs, 128 hidden, 10 outputs
ret = neural_network_init(nn, 256, 128, 10, true, 0.2f);
if (ret) {
    pr_err("Failed to initialize neural network: %d\n", ret);
    kfree(nn);
    return ret;
}
```

### 2. Making Predictions
Syntax:
```c
neural_network_predict(neural_network_t *nn, const s32 *input, s32 *output);
```

Example:
```c
s32 input[256];  // Input data in fixed-point format
s32 output[10];  // Output predictions
int ret;

// Prepare input data (convert to fixed-point)
for (int i = 0; i < 256; i++) {
    input[i] = INT_TO_FP(raw_input[i]);
}

// Make prediction
ret = neural_network_predict(nn, input, output);
if (ret) {
    pr_err("Prediction failed: %d\n", ret);
    return ret;
}

// Process results (convert from fixed-point)
for (int i = 0; i < 10; i++) {
    int result = FP_TO_INT(output[i]);
    pr_info("Output[%d]: %d\n", i, result);
}
```

### 3. Using Cached Predictions
Syntax:
```c
neural_network_predict_cached(neural_network_t *nn, const s32 *input, s32 *output);
```

Example:
```c
// For repeated predictions with similar inputs, use caching
ret = neural_network_predict_cached(nn, input, output);
if (ret) {
    pr_err("Cached prediction failed: %d\n", ret);
    return ret;
}
```

### 4. Network Cleanup
Syntax:
```c
neural_network_unref(neural_network_t *nn);
```

Example:
```c
// Clean up resources
neural_network_unref(nn);  // Uses reference counting
```